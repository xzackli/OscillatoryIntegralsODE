var documenterSearchIndex = {"docs":
[{"location":"api_index/#Index","page":"API","title":"Index","text":"","category":"section"},{"location":"api_index/","page":"API","title":"API","text":"","category":"page"},{"location":"api_index/","page":"API","title":"API","text":"Modules = [OscillatoryIntegralsODE]","category":"page"},{"location":"api_index/#OscillatoryIntegralsODE.BesselJIntegral","page":"API","title":"OscillatoryIntegralsODE.BesselJIntegral","text":"BesselJIntegral{T}(ν, r)\n\nThis constructs a Bessel integration problem which solves\n\nI = int_a^b f(x) J_nu(r x) dx\n\nand produces output of type {T}. ```\n\n\n\n\n\n","category":"type"},{"location":"api_index/#OscillatoryIntegralsODE.HarmonicIntegral-Union{Tuple{Tpar}, Tuple{T}} where Tpar where T","page":"API","title":"OscillatoryIntegralsODE.HarmonicIntegral","text":"HarmonicIntegral{T}(ω)\n\nThis constructs a spherical Bessel integration problem which solves\n\nI = int_a^b f(x) e^i omega x  dx\n\nand produces output of type {T}. ```\n\n\n\n\n\n","category":"method"},{"location":"api_index/#OscillatoryIntegralsODE.SphericalBesselJIntegral","page":"API","title":"OscillatoryIntegralsODE.SphericalBesselJIntegral","text":"SphericalBesselJIntegral{T}(ν, r)\n\nThis constructs a spherical Bessel integration problem which solves\n\nI = int_a^b f(x) j_nu(r x) dx\n\nand produces output of type {T}. ```\n\n\n\n\n\n","category":"type"},{"location":"api_index/#OscillatoryIntegralsODE.levintegrate","page":"API","title":"OscillatoryIntegralsODE.levintegrate","text":"levintegrate(oi, f, a, b, alg=Vern9(); ode_kwargs...)\n\nThis computes int_a^b f(x) w(x) dx for 0  a  b, wheref(x)is a smooth, univariate function, andw(x)` is a highly-oscillatory function.\n\nArguments:\n\noi::OscillatoryIntegral: parameters of the highly-oscillatory integral\nf: the function to be integrated\na: lower integration bound, must be greater than zero\nb: upper integration bound, must be greater than a\nalg: algorithm used in the ODE solve, use probably want something high order\n\nKeywords\n\nAny keyword arguments are passed to the solve call of the Levin ODE\n\nReturns:\n\nthe result of the integral\n\nExamples\n\njulia> f(x) = exp(-x^2/16)\n       bi = BesselJIntegral{Float64}(100., 100.)  # nu, r\n       levintegrate(bi, f, 1.0, 5.0, Vern9(); abstol=1e-6, reltol=1e-6)\n\n0.006311599451652101\n\n\n\n\n\n","category":"function"},{"location":"","page":"Home","title":"Home","text":"CurrentModule = OscillatoryIntegralsODE","category":"page"},{"location":"#OscillatoryIntegralsODE","page":"Home","title":"OscillatoryIntegralsODE","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"This package performs highly oscillatory quadrature by combining a Levin method (Levin 1994) with an ODE solver. It currently supports Bessel, spherical Bessel, and harmonic integrals. ","category":"page"},{"location":"#Background","page":"Home","title":"Background","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Consider the commonly-encountered class of integrals","category":"page"},{"location":"","page":"Home","title":"Home","text":"I = int_a^b g(x) S(rx)  dx","category":"page"},{"location":"","page":"Home","title":"Home","text":"where g(x) is a well-behaved function, but S is rapidly-oscillating for large values of r. In cosmology, the spherical Bessel function j_nu(rx) is a common example of a highly oscillatory S. Traditional Gaussian quadrature has poor convergence properties for such integrals, as the number of required nodes scales with frequency r. There is a rich literature on other quadrature approaches (for a review, see Huybrechs and Olver 2012). This package uses the Levin method in combination with an ODE solver to efficiently evaluate integrals with S functions of Bessel J_nu(rx), spherical Bessel j_nu(rx), and harmonic e^i omega x for finite 0  a  b.","category":"page"},{"location":"","page":"Home","title":"Home","text":"The main idea of the Levin method (Levin 1994) is to transform the integral of a rapidly-oscillating function into an equivalent non-rapidly oscillatory system of ordinary differential equations. We now follow Levin, and let mathbff(x) = ( f_1(x) ldots f_m(x) )^T be an m-vector of non-rapidly oscillatory functions, and mathbfw(x) = ( w_1(x) ldots w_m(x) )^T be an m-vector of linearly independent rapidly oscillatory functions. Now suppose your oscillatory functions w_i have some special properties, such that the derivative vector mathbfw(x) is always some linear transformation of mathbfw. Then we could write ","category":"page"},{"location":"","page":"Home","title":"Home","text":"mathbfw(x) = mathbfA(x) mathbfw(x)","category":"page"},{"location":"","page":"Home","title":"Home","text":"We are lucky, as many common rapidly oscillatory functions, such as those of the Bessel, spherical Bessel, harmonic, sine, and cosine transforms, satisfy such a relation. For example, the derivative of the Bessel function can be expressed as a linear combination of two Bessel functions, and they are also subject to a convenient recursion relation among different orders. One only needs m=2 to be able to write a mathbfw(x) containing a desired Bessel function (see later sections).","category":"page"},{"location":"","page":"Home","title":"Home","text":"Now suppose there exists an m-vector of functions mathbfp(x) such that ","category":"page"},{"location":"","page":"Home","title":"Home","text":"fracddx left( mathbfp cdot mathbfw right) approx mathbff cdot mathbfw","category":"page"},{"location":"","page":"Home","title":"Home","text":"If we could obtain such a mathbfp, then by the fundamental theorem of calculus, our integral becomes","category":"page"},{"location":"","page":"Home","title":"Home","text":"I approx int_a^b fracddx left( mathbfp   cdot mathbfw right) = mathbfp(b) cdot mathbfb - mathbfp(a) cdot mathbfa","category":"page"},{"location":"","page":"Home","title":"Home","text":"We have thus reduced our integral to finding an approximation to functions mathbfp(x). Applying the product rule, we have (recall that we can write mathbfw^prime = mathbfA mathbfw)","category":"page"},{"location":"","page":"Home","title":"Home","text":"(mathbfp cdot mathbfw)^prime = mathbfp^prime cdot mathbfw + mathbfp cdot mathbfw^prime = mathbfp^prime cdot mathbfw + mathbfp cdot mathbfA mathbfw = (mathbfp^prime + mathbfA^T mathbfp) cdot mathbfw approx mathbff cdot mathbfw","category":"page"},{"location":"","page":"Home","title":"Home","text":"Thus mathbfp should be an approximate solution to ","category":"page"},{"location":"","page":"Home","title":"Home","text":"mathbfp^prime + mathbfA^T mathbfp = mathbff","category":"page"},{"location":"","page":"Home","title":"Home","text":"We solve this ODE using an ODE solver. As there are no boundary conditions here, we generally choose the initial condition p(a) = mathbf0. We then only need to obtain the ODE solution at b, and we have our integral I approx mathbfp(b) cdot mathbfw(b). If the ODE solver is a Runge Kutta method, then there's a good chance it corresponds to some kind of Taylor-based collocation method, which is typically what the literature discuses.","category":"page"},{"location":"#Bessel-Functions","page":"Home","title":"Bessel Functions","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Bessel functions of the first kind J_nu satisfy ","category":"page"},{"location":"","page":"Home","title":"Home","text":"J^prime_nu - 1(x) = fracnu - 1x J_nu - 1(x) - J_nu(x) quad quad\nJ^prime_nu(x) =  J_nu - 1(x) - fracnux J_nu(x)","category":"page"},{"location":"","page":"Home","title":"Home","text":"That means we can have mathbfw(x) = (J_nu - 1(x) J_nu(x)) and mathbfw^prime = mathbfA mathbfw if ","category":"page"},{"location":"","page":"Home","title":"Home","text":"mathbfA(x) = beginpmatrix\n(nu - 1)  x  -r  \nr   - nu  x\nendpmatrix","category":"page"},{"location":"","page":"Home","title":"Home","text":"We define mathbff(x) = (0 f(x)). We now have our two variables mathbfp^prime + mathbfA^T mathbfp = mathbff. Once we solve that ODE, we can get our result I approx mathbfp(b) cdot mathbfw(b).","category":"page"},{"location":"#Spherical-Bessel-Functions","page":"Home","title":"Spherical Bessel Functions","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Spherical Bessel functions of the first kind j_nu satisfy a similar differential relation, such that for mathbfw(x) = (j_nu - 1(x) j_nu(x)), we have","category":"page"},{"location":"","page":"Home","title":"Home","text":"mathbfA(x) = beginpmatrix\n(nu - 1)  x  -r  \nr   - (nu+1)  x\nendpmatrix","category":"page"},{"location":"#Harmonic-Integrals","page":"Home","title":"Harmonic Integrals","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"The function e^i omega x requires only m=1. In this case we have a scalar A,","category":"page"},{"location":"","page":"Home","title":"Home","text":"A(x) = i omega","category":"page"},{"location":"","page":"Home","title":"Home","text":"for w(x) = e^i omega x, and pretty trivially w^prime(x) = A(x) w(x).","category":"page"},{"location":"#Usage","page":"Home","title":"Usage","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"To calculate a univariate integral with a Bessel function","category":"page"},{"location":"","page":"Home","title":"Home","text":"I = int_a^b f(x) J_nu(r x)  dx","category":"page"},{"location":"","page":"Home","title":"Home","text":"one needs to initialize a BesselJIntegral with the output type T, order nu and frequency r. Consider an example,","category":"page"},{"location":"","page":"Home","title":"Home","text":"I = int_a^b e^-x^216 J_100(200 x)  dx","category":"page"},{"location":"","page":"Home","title":"Home","text":"using OscillatoryIntegralsODE\n# we integrate the Bessel with this f\nf(x) = exp(-x^2/16)\n# set up problem with output type Float64, Bessel order nu=100, frequency r=100\nbi = BesselJIntegral{Float64}(100., 200.)  # nu, r\n# now integrate over (a, b) = (1, 5)\nlevintegrate(bi, f, 1.0, 5.0; abstol=1e-6, reltol=1e-6)","category":"page"},{"location":"","page":"Home","title":"Home","text":"0.00002612881708428357","category":"page"},{"location":"","page":"Home","title":"Home","text":"note: Note\nLevin methods for Bessel functions can only integrate 0  a  b, because A(x) diverges as it approaches zero. If you need to get down to 0, consider using Gauss quadrature from 0 to the first peak in the Bessel function. Probably the fastest way to do this is to use one of the many asymptotic results for the smallest positive zero (Watson 1922) with x_nu = nu + 1855757 nu^13 + O(nu^-13).","category":"page"},{"location":"","page":"Home","title":"Home","text":"We could have used a different ODE integrator. The default levintegrate uses Vern9 from OrdinaryDiffEq.jl.","category":"page"},{"location":"","page":"Home","title":"Home","text":"using OrdinaryDiffEq\nlevintegrate(bi, f, 1.0, 5.0, Vern9(); abstol=1e-6, reltol=1e-6)","category":"page"},{"location":"","page":"Home","title":"Home","text":"Note that the keyword arguments for levintegrate are passed directly to the ODE solve call.","category":"page"},{"location":"","page":"Home","title":"Home","text":"Similarly for Spherical Bessel functions j_nu(rx), here's an example integral,","category":"page"},{"location":"","page":"Home","title":"Home","text":"I = int_1^5 e^-x^216 j_100(100 x) dx","category":"page"},{"location":"","page":"Home","title":"Home","text":"nu = 100.\nr = 100.\nf(x) = exp(-x^2/16)\nbi = SphericalBesselJIntegral{Float64}(nu, r)\nlevintegrate(bi, f, 1.0, 5.0, Vern9(); abstol=1e-6, reltol=1e-6)","category":"page"},{"location":"","page":"Home","title":"Home","text":"0.0008322179291456167","category":"page"},{"location":"","page":"Home","title":"Home","text":"We also include an integral type for the harmonic transform e^i omega x,","category":"page"},{"location":"","page":"Home","title":"Home","text":"ω = 100.\nf(x) = exp(-x^2/16)\nhi = HarmonicIntegral{Complex{Float64}}(ω)\nresult = levintegrate(hi, f, 1.0, 5.0, Vern9(); abstol=1e-6, reltol=1e-6)","category":"page"},{"location":"","page":"Home","title":"Home","text":"0.003797996803011478 + 0.00995319484859839im","category":"page"}]
}
