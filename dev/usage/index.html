<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Usage · OscillatoryIntegralsODE.jl</title><link rel="canonical" href="https://xzackli.github.io/OscillatoryIntegralsODE.jl/usage/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">OscillatoryIntegralsODE.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../background/">Background</a></li><li class="is-active"><a class="tocitem" href>Usage</a></li><li><a class="tocitem" href="../api_index/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Usage</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Usage</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/xzackli/OscillatoryIntegralsODE.jl/blob/master/docs/src/usage.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Usage"><a class="docs-heading-anchor" href="#Usage">Usage</a><a id="Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Usage" title="Permalink"></a></h1><p>To calculate a univariate integral with a Bessel function</p><p class="math-container">\[I = \int_a^b f(x) J_{\nu}(r x) \, dx,\]</p><p>one needs to initialize a <a href="../api_index/#OscillatoryIntegralsODE.BesselJIntegral"><code>BesselJIntegral</code></a> with the output type <code>T</code>, order <span>$\nu$</span> and frequency <span>$r$</span>. Consider an example,</p><p class="math-container">\[I = \int_a^b e^{-x^2/16} J_{100}(200 x) \, dx,\]</p><pre><code class="language-julia">using OscillatoryIntegralsODE
# we integrate the Bessel with this f
f(x) = exp(-x^2/16)
# set up problem with output type Float64, Bessel order nu=100, frequency r=100
bi = BesselJIntegral{Float64}(100., 200.)  # nu, r
# now integrate over (a, b) = (1, 5)
levintegrate(bi, f, 1.0, 5.0; abstol=1e-6, reltol=1e-6)</code></pre><pre><code class="language-none">0.00002612881708428357</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Levin methods for Bessel functions can only integrate <span>$0 &lt; a &lt; b$</span>, because <span>$A(x)$</span> diverges as it approaches zero. If you need to get down to 0, consider using Gauss quadrature from 0 to the first peak in the Bessel function. Probably the fastest way to do this is to use one of the many asymptotic results for the smallest positive zero (Watson 1922) with <span>$x_{\nu} = \nu + 1.855757 \nu^{1/3} + O(\nu^{-1/3})$</span>.</p></div></div><p>We could have used a different ODE integrator. The default <a href="../api_index/#OscillatoryIntegralsODE.levintegrate"><code>levintegrate</code></a> uses <code>Vern9</code> from <a href="https://diffeq.sciml.ai/stable/solvers/ode_solve/#Recommended-Methods">OrdinaryDiffEq.jl</a>.</p><pre><code class="language-julia">using OrdinaryDiffEq
levintegrate(bi, f, 1.0, 5.0, Vern9(); abstol=1e-6, reltol=1e-6)</code></pre><p>Note that the keyword arguments for <a href="../api_index/#OscillatoryIntegralsODE.levintegrate"><code>levintegrate</code></a> are passed directly to the ODE <code>solve</code> call.</p><p>Similarly for Spherical Bessel functions <span>$j_{\nu}(rx)$</span>, here&#39;s an example integral,</p><p class="math-container">\[I = \int_1^5 e^{-x^2/16} j_{100}(100 x)\, dx\]</p><pre><code class="language-julia">nu = 100.
r = 100.
f(x) = exp(-x^2/16)
bi = SphericalBesselJIntegral{Float64}(nu, r)
levintegrate(bi, f, 1.0, 5.0, Vern9(); abstol=1e-6, reltol=1e-6)</code></pre><pre><code class="language-none">0.0008322179291456167</code></pre><p>We also include an integral type for the harmonic transform <span>$e^{i \omega x}$</span>,</p><pre><code class="language-julia">ω = 100.
f(x) = exp(-x^2/16)
hi = HarmonicIntegral{Complex{Float64}}(ω)
result = levintegrate(hi, f, 1.0, 5.0, Vern9(); abstol=1e-6, reltol=1e-6)</code></pre><pre><code class="language-none">0.003797996803011478 + 0.00995319484859839im</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../background/">« Background</a><a class="docs-footer-nextpage" href="../api_index/">API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 19 February 2021 03:20">Friday 19 February 2021</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
